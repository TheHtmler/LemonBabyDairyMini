<view class="modal" wx:if="{{visible}}" bindtap="handleMaskTap" catchtouchmove="stop">
  <view class="modal-content" catchtap="stop">
    <view class="modal-header">
      <text>{{title}}</text>
    </view>
    <view class="modal-body">
      <view class="modal-info-row">
        <text class="modal-label">药物名称:</text>
        <block wx:if="{{showMedicationPicker}}">
          <picker mode="selector" range="{{medications}}" range-key="name" value="{{selectedMedicationIndex}}" bindchange="handleMedicationChange">
            <view class="modal-picker">
              <text class="modal-value">{{selectedMedicationName ? selectedMedicationName : '请选择药物'}}</text>
              <text class="edit-icon">▼</text>
            </view>
          </picker>
        </block>
        <block wx:else>
          <text class="modal-value">{{selectedMedicationName}}</text>
        </block>
      </view>
      <view class="modal-info-row">
        <text class="modal-label">药物剂量:</text>
        <view class="dosage-input-container">
          <input type="digit" class="dosage-input" value="{{dosage}}" bindinput="handleDosageInput" placeholder="请输入药物剂量" />
          <text class="dosage-unit">{{unit}}</text>
        </view>
      </view>
      <view class="modal-info-row" wx:if="{{frequency}}">
        <text class="modal-label">服用频率:</text>
        <text class="modal-value">{{frequency}}</text>
      </view>
      <view class="modal-info-row">
        <text class="modal-label">服用时间:</text>
        <picker mode="time" value="{{time}}" start="00:00" end="23:59" bindchange="handleTimeChange">
          <view class="modal-time-picker">{{time}} <text class="edit-icon">✎</text></view>
        </picker>
      </view>
      <view class="modal-notes">
        <text class="modal-label">备注</text>
        <textarea class="notes-input" placeholder="可选，记录特殊说明"
                  value="{{notes}}" bindinput="handleNotesInput"></textarea>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-btn cancel" bindtap="handleCancel">{{cancelText}}</button>
      <button class="modal-btn confirm" bindtap="handleConfirm">{{confirmText}}</button>
    </view>
  </view>
</view>
