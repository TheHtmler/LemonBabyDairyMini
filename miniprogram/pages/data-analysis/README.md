# 数据分析页面

## 功能说明

数据分析页面用于展示周、月维度的喂养数据聚合和趋势分析。

## 主要功能

### 1. 时间维度选择

- **周视图**：展示最近一周的数据（周一至周日）
- **月视图**：展示当前月份的数据
- 支持查看历史周/月数据（上一周、上一月等）
- 快速返回当前周/月

### 2. 数据统计概览

显示所选时间范围内的平均数据：

- 平均奶量（总奶量）
- 平均热量（kcal）
- 平均天然奶量
- 平均特奶量
- 记录天数统计

### 3. 三个核心曲线图

#### 📈 奶量统计曲线

展示每日的：

- 总奶量变化趋势
- 天然奶量变化趋势
- 特奶量变化趋势

通过三条曲线对比，可以直观看到宝宝每日奶量摄入情况及组成比例的变化。

#### 🥛 蛋白质系数曲线

采用**多条曲线**展示每日的蛋白质摄入系数：

- **总蛋白系数**（g/kg）：天然蛋白 + 特殊蛋白系数（橙色）
- **天然蛋白系数**（g/kg）：天然蛋白摄入量 ÷ 体重（绿色）
- **特殊蛋白系数**（g/kg）：特殊蛋白摄入量 ÷ 体重（蓝色）

**特点**：

- Y 轴范围动态调整（2.0 - 3.0 g/kg），更清晰展示小数变化
- 刻度精确到小数点后一位
- 三条曲线可对比查看总量和组成

**标准参考**：

- 天然蛋白系数约为 **1.2 g/kg**
- 总蛋白摄入建议范围：**1.8 - 2.2 g/kg**

#### 🔥 总热量曲线

展示每日的：

- 总热量摄入（kcal）

根据母乳热量（67kcal/100ml）和特奶热量（70kcal/100ml）计算得出，帮助家长监控宝宝每日热量摄入是否充足。

## 数据来源

从云数据库 `feeding_records` 集合中获取喂养记录数据，根据所选时间范围进行聚合计算。

## 计算规则

### 蛋白质系数计算

- 天然蛋白摄入 = 天然奶量(ml) × 母乳蛋白浓度(1.1g/100ml) ÷ 100
- 特殊蛋白摄入 = 特奶粉量(g) × 特奶蛋白浓度(13.1%) ÷ 100
- 天然蛋白系数 = 天然蛋白摄入(g) ÷ 体重(kg)
- 特殊蛋白系数 = 特殊蛋白摄入(g) ÷ 体重(kg)
- **总蛋白系数 = 天然蛋白系数 + 特殊蛋白系数**
- **标准参考**：
  - 天然蛋白系数约为 1.2 g/kg
  - 总蛋白系数建议范围：1.8 - 2.2 g/kg

### 热量计算

- 母乳/天然奶热量：67 kcal/100ml
- 特奶热量：70 kcal/100ml
- 总热量 = (天然奶量 × 0.67) + (特奶量 × 0.70)

### 数据聚合

- 按日期分组，计算每日总量和系数
- 对于没有记录的日期，显示为 0
- 计算平均值时只统计有记录的天数
- **重要**：蛋白质系数需要体重数据才能计算

## 使用场景

1. **日常监控**：查看宝宝近期的喂养趋势
2. **营养评估**：通过热量和蛋白质比例曲线评估营养摄入
3. **数据对比**：对比不同时间段的喂养情况
4. **医疗参考**：为医生诊断提供数据支持

## 技术实现

- 使用自定义 `ec-canvas` 组件绘制图表
- 基于 Canvas 2D API 实现曲线图绘制
- 响应式设计，支持不同屏幕尺寸
- 下拉刷新支持

## 入口位置

从"我的"页面点击"数据分析"菜单项即可进入。
